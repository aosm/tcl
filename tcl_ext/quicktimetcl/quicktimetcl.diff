Index: pkgIndex.tcl
===================================================================
RCS file: /cvsroot/quicktimetcl/quicktimetcl/pkgIndex.tcl,v
retrieving revision 1.3
diff -u -p -r1.3 pkgIndex.tcl
--- pkgIndex.tcl	16 May 2004 15:05:50 -0000	1.3
+++ pkgIndex.tcl	23 Jul 2004 15:47:22 -0000
@@ -1,2 +1,2 @@
-package ifneeded QuickTimeTcl 3.1 [list load [file join $dir QuickTimeTcl3.1.dylib]; \
-  source [file join $dir movie.tcl]]
+package ifneeded QuickTimeTcl 3.1 "[list load [file join $dir QuickTimeTcl3.1.dylib]]; \
+  [list source [file join $dir movie.tcl]]"
Index: QuickTimeTcl.pbproj/project.pbxproj
===================================================================
RCS file: /cvsroot/quicktimetcl/quicktimetcl/QuickTimeTcl.pbproj/project.pbxproj,v
retrieving revision 1.9
diff -u -p -r1.9 project.pbxproj
--- QuickTimeTcl.pbproj/project.pbxproj	29 May 2004 07:14:03 -0000	1.9
+++ QuickTimeTcl.pbproj/project.pbxproj	23 Jul 2004 15:47:23 -0000
@@ -121,7 +121,6 @@
 			);
 			buildSettings = {
 				COPY_PHASE_STRIP = NO;
-				OPTIMIZATION_CFLAGS = "-O0";
 			};
 			isa = PBXBuildStyle;
 			name = Development;
@@ -171,24 +170,12 @@
 			path = /Library/Frameworks/Tcl.framework/libtclstub8.4.a;
 			refType = 0;
 		};
-		9A57846B043C3778009A6529 = {
-			fileRef = 9A57846A043C3778009A6529;
-			isa = PBXBuildFile;
-			settings = {
-			};
-		};
 		9A57846C043C37A8009A6529 = {
 			isa = PBXFileReference;
 			name = libtkstub8.4.a;
 			path = /Library/Frameworks/Tk.framework/libtkstub8.4.a;
 			refType = 0;
 		};
-		9A57846D043C37A8009A6529 = {
-			fileRef = 9A57846C043C37A8009A6529;
-			isa = PBXBuildFile;
-			settings = {
-			};
-		};
 		9A57CB83042709AD000D8B82 = {
 			buildActionMask = 8;
 			files = (
@@ -550,8 +537,6 @@
 				F5509190036C35B40130931B,
 				F5151068037FF19401FE12CD,
 				F55648FE038142E001A4FCC0,
-				9A57846B043C3778009A6529,
-				9A57846D043C37A8009A6529,
 			);
 			isa = PBXFrameworksBuildPhase;
 			runOnlyForDeploymentPostprocessing = 0;
@@ -579,18 +564,21 @@
 				DYLIB_CURRENT_VERSION = 3.1;
 				EXPORTED_SYMBOLS_FILE = ./PBExportedSymbols;
 				FRAMEWORK_SEARCH_PATHS = "";
-				HEADER_SEARCH_PATHS = "\"$(LOCAL_LIBRARY_DIR)/Frameworks/Tk.framework/Headers\" \"$(LOCAL_LIBRARY_DIR)/Frameworks/Tk.framework/PrivateHeaders\" /Users/matben/C/cvs/tk/macosx /Users/matben/C/cvs/tk/generic";
+				GLOBAL_CFLAGS = "-I`source \"$(TK_FRAMEWORK)/tkConfig.sh\"; echo $${}{TK_SRC_DIR}`/generic -F`dirname \"$(TCL_FRAMEWORK)\"` -F`dirname \"$(TK_FRAMEWORK)\"`";
+				HEADER_SEARCH_PATHS = "\"$(TK_FRAMEWORK)/Headers\" \"$(TK_FRAMEWORK)/PrivateHeaders\"";
 				INSTALL_PATH = "/Library/Tcl/QuickTimeTcl${DYLIB_COMPATIBILITY_VERSION}";
-				LIBRARY_SEARCH_PATHS = "\"$(LOCAL_LIBRARY_DIR)/Frameworks/Tcl.framework\" \"$(LOCAL_LIBRARY_DIR)/Frameworks/Tk.framework\" \"$(LOCAL_LIBRARY_DIR)/Frameworks/Tk.framework/Headers/X11\"";
+				LIBRARY_SEARCH_PATHS = "\"$(TCL_FRAMEWORK)\" \"$(TK_FRAMEWORK)\"";
 				LIBRARY_STYLE = DYNAMIC;
 				OPTIMIZATION_CFLAGS = "-O0";
-				OTHER_CFLAGS = "-DUSE_TCL_STUBS -DTARGET_OS_MAC=1 -DTARGET_API_MAC_CARBON=1 -DUSE_TK_STUBS -DMAC_OSX_TK";
-				OTHER_LDFLAGS = "";
+				OTHER_CFLAGS = "-DUSE_TCL_STUBS -DTARGET_OS_MAC=1 -DTARGET_API_MAC_CARBON=1 -DUSE_TK_STUBS -DMAC_OSX_TK -DHAVE_LIMITS_H -DHAVE_UNISTD_H";
+				OTHER_LDFLAGS = "-ltclstub8.4 -ltkstub8.4";
 				OTHER_LIBTOOL_FLAGS = "";
 				OTHER_REZFLAGS = "";
 				PRODUCT_NAME = QuickTimeTcl3.1.dylib;
 				REZ_EXECUTABLE = YES;
 				SECTORDER_FLAGS = "";
+				TCL_FRAMEWORK = "\"$(LOCAL_LIBRARY_DIR)/Frameworks/Tcl.framework\"";
+				TK_FRAMEWORK = "\"$(LOCAL_LIBRARY_DIR)/Frameworks/Tk.framework\"";
 				WARNING_CFLAGS = "-Wmost -Wno-four-char-constants -Wno-unknown-pragmas";
 			};
 			dependencies = (
