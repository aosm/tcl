# This file is a Tcl script to test out ICO reading and writing.
# It is organized in the standard fashion for Tcl tests.
#

puts "img::ico [package require img::ico]"

set icodata \
{AAABAAEAICAAAAEACACoCAAAFgAAACgAAAAgAAAAQAAAAAEACAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAADZ2dkAAAD/AQAAAAGAgAAB//8AAQD//wEAAIABAIAAAQAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////////////////////////////
/wAAAAAA/wcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwf/AAAAAAD/BwcHBwcHBwcHBwcHBwcH
BwcHBwcHBwcHB/8AAAAAAP8HBwcHB/8HBwcHBwcHBwcHBwcHBwcHBwcH/wAAAAAA/wQEBAQE
/wQEBAQEBAQGBgYGBgYGBgQEBAT/AAAAAAD/BAQEBAT/BAQEBAQEBAYGBgYGBgYGBAQEBP8A
AAAAAP8EBAQEBAH/BAQEBAQEBgYGBgYGBgYEBAQE/wAAAAAA/wQEBAQEAf8BAQQEBAQGBgYG
BgYGBgQEBAT/AAAAAAD/BAQEBAQB/wEBBAQEBAYGBgYGBgYGBAQEBP8AAAAAAP8EBAQEBAEB
/wEBBAQEBAYGBgYGBgQEBAQE/wAAAAAA/wQEBAQEBAH//wEBBAQEBAYGBgYEBAQEBAT/AAAA
AAD/BAQEBAQEAQH//wEEBAQEBAYGBAQEBAQEBP8AAAAAAP8EBAQEBAQBAQH/AQEEBAQEBAQE
BAQEBAQE/wAAAAAA/wQEBAQEBAQBAQH/AQQEBAQEBAQEBAQEBAT/AAAAAAD/BAQEBQUEBAQB
Af8BAQQEBAQEBAQEBAQEBP8AAAAAAP8EBAQFBQQEBAEB//8BBAQEBAQEBAQEBAQE/wAAAAAA
/wQEBAQEBAQEAQEB/wEBBAQEBAQEBAQEBAT/AAAAAAD/BAQEBAQEBAQEAQH//wEBBAQEBAQE
BAQEBP8AAAAAAP//////////////AQH/AQH//////////////wAAAAAAAAAA//8AAAAAAAAB
Af8BAQEAAAAAAP//AAAAAAAAAAAAAAAAAP//AAAAAAEBAf8BAQEAAP//AAAAAAAAAAAAAAAA
AAAAAAD//wAAAAEBAf8BAQH/AAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAQEBAf8BAQEAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAP//AAEBAf//AQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/
AwEBAf8BAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAf8BAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAABAf8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAP/////////////////////AAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AA
AAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAH+fgfP/54DP//nAP/
/+QD///5Af///gH////B////8f//////}


test ico-1.1 {} {
    catch {image delete i}
    image create photo i -file [file join $tcltest::testsDirectory img.ico]
    i data -format ico
} $icodata
test ico-1.2 {} {
    catch {image delete i}
    image create photo i -data $icodata
    set data [i data -format ico]
} $icodata
test ico-1.3 {} {
    i blank
    i put $icodata
    set data [i data -format ico]
} $icodata
test ico-1.4 {} {
    i blank
    i put $icodata -format ico
    set data [i data -format ico]
} $icodata

if {[info tclversion] < 8.0} {
    return
}

test ico-2.0 {Binary I/O with ICO images} {
    i blank
    set f [open [file join $tcltest::testsDirectory img.ico] r]
    fconfigure $f -translation binary
    set return [catch {i put [read $f]} msg]
    close $f
    lappend return $msg
} {0 {}}
